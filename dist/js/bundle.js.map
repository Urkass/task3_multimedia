{"version":3,"sources":["webpack:///bundle.js","webpack:///webpack/bootstrap 2eec2b56b0c7d78b337d","webpack:///./src/js/index.js","webpack:///./src/js/app.js","webpack:///./src/js/player.js","webpack:///./src/js/song.js","webpack:///./src/js/subtitles.js","webpack:///./src/js/video.js","webpack:///./~/subtitles-parser/index.js"],"names":["modules","__webpack_require__","moduleId","installedModules","exports","module","id","loaded","call","m","c","p","_interopRequireDefault","obj","__esModule","default","onDOMContentLoaded","window","app","_app2","_app","document","addEventListener","_classCallCheck","instance","Constructor","TypeError","Object","defineProperty","value","_player","_player2","App","onFormSubmit","e","preventDefault","this","links","video","crossorigin","form","querySelector","subtitles","audio","pages","pageForm","classList","add","pagePreloader","remove","player","pagePlayer","bind","_createClass","defineProperties","target","props","i","length","descriptor","enumerable","configurable","writable","key","protoProps","staticProps","prototype","_song","_song2","_video","_video2","_subtitles","_subtitles2","Player","init","videoWidth","videoHeight","prepareWebGL","canvas","gl","sourceCanvas","program","webglContext","createProgram","vertexCode","vertexShader","createShader","VERTEX_SHADER","shaderSource","compileShader","fragmentCode","fragmentShader","FRAGMENT_SHADER","attachShader","linkProgram","useProgram","positionLocation","getAttribLocation","texcoordLocation","GL_TIME_UNIFORM","getUniformLocation","resolutionLocation","uniform2f","webglCanvas","width","height","buffer","createBuffer","vertices","bindBuffer","ARRAY_BUFFER","bufferData","Float32Array","STATIC_DRAW","enableVertexAttribArray","vertexAttribPointer","FLOAT","textureCoordinates","texture","createTexture","bindTexture","TEXTURE_2D","texParameteri","TEXTURE_WRAP_S","CLAMP_TO_EDGE","TEXTURE_WRAP_T","TEXTURE_MIN_FILTER","NEAREST","TEXTURE_MAG_FILTER","drawScreen","t","videoElement","ended","context","drawImage","theCanvas","checkForSubtitles","undefined","delta","previousTime","postprocessWebGL","requestAnimationFrame","GL_TIME","uniform1f","texImage2D","RGBA","UNSIGNED_BYTE","viewport","enable","DEPTH_TEST","clear","COLOR_BUFFER_BIT","drawArrays","TRIANGLES","index","data","currentTime","endTime","flag","pause","timerForSubtitles","drawSubtitlesPicture","text","delay","_this2","setTimeout","pauseFlag","play","fontsize","fillStyle","fillRect","font","textBaseline","textAlign","createSubtitlesText","lines","split","forEach","elem","fillText","getElementById","getContext","_this","playButton","pauseButton","song","Song","link","Audio","crossOrigin","AudioContext","webkitAudioContext","source","createMediaElementSource","gainNode","createGain","addDirtyEffects","distortion","createWaveShaper","biquadFilter","createBiquadFilter","type","frequency","gain","connect","generateWHiteNoize","destination","node","createScriptProcessor","onaudioprocess","output","outputBuffer","getChannelData","Math","random","disconnect","_subtitlesParser","_subtitlesParser2","Subtitles","getFile","xhr","XMLHttpRequest","open","send","onreadystatechange","readyState","fromSrt","responseText","parseData","countSeconds","time","replace","hours","slice","minutes","Number","seconds","startTime","Video","createElement","setAttribute","videoDiv","appendChild","muted","parser","pItems","ms","useMs","regex","shift","items","push","trim","timeMs","toSrt","Array","res","s","isNaN","msTime","parseInt","val","parts","exec","measures","toString","join"],"mappings":"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","file":"bundle.js","sourcesContent":["/******/ (function(modules) { // webpackBootstrap\n/******/ \t// The module cache\n/******/ \tvar installedModules = {};\n/******/\n/******/ \t// The require function\n/******/ \tfunction __webpack_require__(moduleId) {\n/******/\n/******/ \t\t// Check if module is in cache\n/******/ \t\tif(installedModules[moduleId])\n/******/ \t\t\treturn installedModules[moduleId].exports;\n/******/\n/******/ \t\t// Create a new module (and put it into the cache)\n/******/ \t\tvar module = installedModules[moduleId] = {\n/******/ \t\t\texports: {},\n/******/ \t\t\tid: moduleId,\n/******/ \t\t\tloaded: false\n/******/ \t\t};\n/******/\n/******/ \t\t// Execute the module function\n/******/ \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n/******/\n/******/ \t\t// Flag the module as loaded\n/******/ \t\tmodule.loaded = true;\n/******/\n/******/ \t\t// Return the exports of the module\n/******/ \t\treturn module.exports;\n/******/ \t}\n/******/\n/******/\n/******/ \t// expose the modules object (__webpack_modules__)\n/******/ \t__webpack_require__.m = modules;\n/******/\n/******/ \t// expose the module cache\n/******/ \t__webpack_require__.c = installedModules;\n/******/\n/******/ \t// __webpack_public_path__\n/******/ \t__webpack_require__.p = \"\";\n/******/\n/******/ \t// Load entry module and return exports\n/******/ \treturn __webpack_require__(0);\n/******/ })\n/************************************************************************/\n/******/ ([\n/* 0 */\n/***/ function(module, exports, __webpack_require__) {\n\n\t'use strict';\n\t\n\tvar _app = __webpack_require__(1);\n\t\n\tvar _app2 = _interopRequireDefault(_app);\n\t\n\tfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\t\n\tdocument.addEventListener('DOMContentLoaded', onDOMContentLoaded);\n\t\n\tfunction onDOMContentLoaded() {\n\t    window.app = new _app2.default();\n\t}\n\n/***/ },\n/* 1 */\n/***/ function(module, exports, __webpack_require__) {\n\n\t'use strict';\n\t\n\tObject.defineProperty(exports, \"__esModule\", {\n\t    value: true\n\t});\n\t\n\tvar _player = __webpack_require__(2);\n\t\n\tvar _player2 = _interopRequireDefault(_player);\n\t\n\tfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\t\n\tfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\t\n\tvar App = function App() {\n\t    _classCallCheck(this, App);\n\t\n\t    // если ипсользовать ссылки со сторонних сайтов, то пригодится cors-сервер\n\t    // const crossorigin = 'http://cors.io/?u=';\n\t    var crossorigin = '';\n\t    this.form = document.querySelector('.panel__form');\n\t    this.pages = {\n\t        'pageForm': document.querySelector('.page_content_form'),\n\t        'pagePreloader': document.querySelector('.page_content_preloader'),\n\t        'pagePlayer': document.querySelector('.page_content_player')\n\t    };\n\t\n\t    this.links = {\n\t        video: '',\n\t        subtitles: '',\n\t        audio: ''\n\t    };\n\t\n\t    this.form.addEventListener('submit', onFormSubmit.bind(this));\n\t\n\t    function onFormSubmit(e) {\n\t        e.preventDefault();\n\t\n\t        this.links.video = crossorigin + this.form.querySelector('[name=\"video\"]').value;\n\t        this.links.subtitles = crossorigin + this.form.querySelector('[name=\"subtitles\"]').value;\n\t        this.links.audio = crossorigin + this.form.querySelector('[name=\"audio\"]').value;\n\t\n\t        this.pages.pageForm.classList.add('page_hidden');\n\t        this.pages.pagePreloader.classList.remove('page_hidden');\n\t        this.pages.player = new _player2.default(this.links, this.pages);\n\t    }\n\t};\n\t\n\texports.default = App;\n\n/***/ },\n/* 2 */\n/***/ function(module, exports, __webpack_require__) {\n\n\t'use strict';\n\t\n\tObject.defineProperty(exports, \"__esModule\", {\n\t    value: true\n\t});\n\t\n\tvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\t\n\tvar _song = __webpack_require__(3);\n\t\n\tvar _song2 = _interopRequireDefault(_song);\n\t\n\tvar _video = __webpack_require__(5);\n\t\n\tvar _video2 = _interopRequireDefault(_video);\n\t\n\tvar _subtitles = __webpack_require__(4);\n\t\n\tvar _subtitles2 = _interopRequireDefault(_subtitles);\n\t\n\tfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\t\n\tfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\t\n\tvar Player = function () {\n\t    function Player(links, pages) {\n\t        var _this = this;\n\t\n\t        _classCallCheck(this, Player);\n\t\n\t        this.pagePlayer = pages.pagePlayer;\n\t        this.pagePreloader = pages.pagePreloader;\n\t        this.player = this.pagePlayer.querySelector('.player');\n\t        this.playButton = this.player.querySelector('.player__button_function_play');\n\t        this.pauseButton = this.player.querySelector('.player__button_function_pause');\n\t        this.video = new _video2.default(links.video, this.pagePlayer);\n\t        this.song = new _song2.default(links.audio);\n\t        this.subtitles = new _subtitles2.default(links.subtitles);\n\t        this.previousTime = 0;\n\t        this.pauseFlag = true;\n\t\n\t        this.video.videoElement.addEventListener('canplaythrough', function () {\n\t            _this.pagePlayer.classList.remove('page_hidden');\n\t            _this.pagePreloader.classList.add('page_hidden');\n\t            init.call(_this, _this.video.videoElement.videoWidth, _this.video.videoElement.videoHeight);\n\t        });\n\t        this.playButton.addEventListener('click', function () {\n\t            _this.play();\n\t        });\n\t        this.pauseButton.addEventListener('click', function () {\n\t            _this.pause();\n\t        });\n\t\n\t        function init(videoWidth, videoHeight) {\n\t            var theCanvas = document.getElementById('canvas');\n\t            var context = theCanvas.getContext('2d');\n\t            var webglCanvas = document.getElementById('webgl-canvas');\n\t            var webglContext = webglCanvas.getContext('webgl') || webglCanvas.getContext('experimental-webgl');\n\t            webglCanvas.width = theCanvas.width = videoWidth;\n\t            webglCanvas.height = theCanvas.height = videoHeight;\n\t\n\t            var GL_TIME = 0;\n\t            var GL_TIME_UNIFORM = null;\n\t\n\t            prepareWebGL.call(this);\n\t\n\t            this.play();\n\t\n\t            drawScreen.call(this);\n\t\n\t            function prepareWebGL(canvas, gl, sourceCanvas) {\n\t                var program = webglContext.createProgram();\n\t\n\t                var vertexCode = 'attribute vec2 coordinates;' + 'attribute vec2 texture_coordinates;' + 'varying vec2 v_texcoord;' + 'void main() {' + '  gl_Position = vec4(coordinates, 0.0, 1.0);' + '  v_texcoord = texture_coordinates;' + '}';\n\t\n\t                var vertexShader = webglContext.createShader(webglContext.VERTEX_SHADER);\n\t                webglContext.shaderSource(vertexShader, vertexCode);\n\t                webglContext.compileShader(vertexShader);\n\t\n\t                var fragmentCode = 'precision mediump float;' + 'varying vec2 v_texcoord;' + 'uniform sampler2D u_texture;' + 'uniform float u_time;' + 'uniform vec2 u_resolution;' + 'vec2 uv;' + 'vec3 grayscale (vec3 color) {' + '   return vec3(0.2126*color.r + 0.7152*color.g + 0.0722*color.b);' + '}' + 'float rand(vec2 co){' + '   return fract(sin(dot(co.xy ,vec2(12.9898,78.233))) * 43758.5453);' + '}' + 'float rand(float c){' + '   return rand(vec2(c,1.0));' + '}' + 'float randomLine(float seed){' + '   float b = 0.01 * rand(seed);' + '   float a = rand(seed+1.0);' + '   float c = rand(seed+2.0) - 0.5;' + '   float mu = rand(seed+3.0);' + '   float l = 1.0;' + '   if ( mu > 0.2)' + '   l = pow(  abs(a * uv.x + b * uv.y + c ), 1.0/8.0 );' + '   else' + '   l = 2.0 - pow( abs(a * uv.x + b * uv.y + c), 1.0/8.0 );' + '   return mix(0.5, 1.0, l);' + '}' + 'float randomBlotch(float seed){' + '\t  float x = rand(seed);' + '\t  float y = rand(seed+1.0);' + '\t  float s = 0.01 * rand(seed+2.0);' + '\t  vec2 p = vec2(x,y) - uv;' + '\t  p.x *= u_resolution.x / u_resolution.y;' + '\t  float a = atan(p.y,p.x);' + '\t  float v = 1.0;' + '\t  float ss = s*s * (sin(6.2831*a*x)*0.1 + 1.0);' + '\t  if ( dot(p,p) < ss ) v = 0.2;' + '\t  else' + '\t\tv = pow(dot(p,p) - ss, 1.0/16.0);' + '   return mix(0.3 + 0.2 * (1.0 - (s / 0.02)), 1.0, v);' + '}' + 'void main() {' + '   uv = v_texcoord.xy;' + '   float t = float(int(u_time * 20.0));' +\n\t                // Сохраняем кадр\n\t                '   vec3 image = texture2D(u_texture, uv).rgb;' +\n\t                // Добавляем ч/б\n\t                '   float luma = dot( vec3(0.2126, 0.7152, 0.0722), image );' + '   image = luma * vec3(0.7, 0.7, 0.7);' +\n\t                // Create a time-varyting vignetting effect\n\t                '   float vI = 16.0 * (uv.x * (1.0-uv.x) * uv.y * (1.0-uv.y));' + 'vI *= mix( 0.7, 1.0, rand(t + 0.5));' +\n\t                // Add additive flicker\n\t                'vI += 1.0 + 0.4 * rand(t+8.);' +\n\t                // Add a fixed vignetting (independent of the flicker)\n\t                'vI *= pow(16.0 * uv.x * (1.0-uv.x) * uv.y * (1.0-uv.y), 0.4);' +\n\t\n\t                // Случайные линии\n\t                'int l = int(8.0 * rand(t+7.0));' + 'if ( 0 < l ) vI *= randomLine( t+6.0+17.* float(0));' + 'if ( 1 < l ) vI *= randomLine( t+6.0+17.* float(1));' + 'if ( 2 < l ) vI *= randomLine( t+6.0+17.* float(2));' + 'if ( 3 < l ) vI *= randomLine( t+6.0+17.* float(3));' + 'if ( 4 < l ) vI *= randomLine( t+6.0+17.* float(4));' + 'if ( 5 < l ) vI *= randomLine( t+6.0+17.* float(5));' + 'if ( 6 < l ) vI *= randomLine( t+6.0+17.* float(6));' + 'if ( 7 < l ) vI *= randomLine( t+6.0+17.* float(7));' +\n\t\n\t                // Случайные пятна\n\t                'image = image * vI;' + 'gl_FragColor = vec4(image, 1.0);' +\n\t\n\t                // Черно-белый эффект (первоначальный метод)\n\t                // '   gl_FragColor = vec4(grayscale(texture2D(u_texture, v_texcoord).rgb), 1.0);' +\n\t                // Зернистость\n\t                '   gl_FragColor.xyz *= (1.0+(rand(uv+t*.01)-.2)*.15);\t' + '}';\n\t\n\t                var fragmentShader = webglContext.createShader(webglContext.FRAGMENT_SHADER);\n\t                webglContext.shaderSource(fragmentShader, fragmentCode);\n\t                webglContext.compileShader(fragmentShader);\n\t\n\t                webglContext.attachShader(program, vertexShader);\n\t                webglContext.attachShader(program, fragmentShader);\n\t\n\t                webglContext.linkProgram(program);\n\t                webglContext.useProgram(program);\n\t\n\t                var positionLocation = webglContext.getAttribLocation(program, 'coordinates');\n\t                var texcoordLocation = webglContext.getAttribLocation(program, 'texture_coordinates');\n\t                GL_TIME_UNIFORM = webglContext.getUniformLocation(program, 'u_time');\n\t                var resolutionLocation = webglContext.getUniformLocation(program, 'u_resolution');\n\t                webglContext.uniform2f(resolutionLocation, webglCanvas.width, webglCanvas.height);\n\t\n\t                var buffer = webglContext.createBuffer();\n\t                var vertices = [-1, -1, 1, -1, -1, 1, -1, 1, 1, -1, 1, 1];\n\t                webglContext.bindBuffer(webglContext.ARRAY_BUFFER, buffer);\n\t                webglContext.bufferData(webglContext.ARRAY_BUFFER, new Float32Array(vertices), webglContext.STATIC_DRAW);\n\t                webglContext.enableVertexAttribArray(positionLocation);\n\t                webglContext.vertexAttribPointer(positionLocation, 2, webglContext.FLOAT, false, 0, 0);\n\t\n\t                buffer = webglContext.createBuffer();\n\t                var textureCoordinates = [0, 1, 1, 1, 0, 0, 0, 0, 1, 1, 1, 0];\n\t                webglContext.bindBuffer(webglContext.ARRAY_BUFFER, buffer);\n\t                webglContext.bufferData(webglContext.ARRAY_BUFFER, new Float32Array(textureCoordinates), webglContext.STATIC_DRAW);\n\t                webglContext.enableVertexAttribArray(texcoordLocation);\n\t                webglContext.vertexAttribPointer(texcoordLocation, 2, webglContext.FLOAT, false, 0, 0);\n\t\n\t                var texture = webglContext.createTexture();\n\t                webglContext.bindTexture(webglContext.TEXTURE_2D, texture);\n\t                webglContext.texParameteri(webglContext.TEXTURE_2D, webglContext.TEXTURE_WRAP_S, webglContext.CLAMP_TO_EDGE);\n\t                webglContext.texParameteri(webglContext.TEXTURE_2D, webglContext.TEXTURE_WRAP_T, webglContext.CLAMP_TO_EDGE);\n\t                webglContext.texParameteri(webglContext.TEXTURE_2D, webglContext.TEXTURE_MIN_FILTER, webglContext.NEAREST);\n\t                webglContext.texParameteri(webglContext.TEXTURE_2D, webglContext.TEXTURE_MAG_FILTER, webglContext.NEAREST);\n\t            }\n\t\n\t            function drawScreen(t) {\n\t                if (this.video.videoElement.ended) {\n\t                    return;\n\t                }\n\t                context.drawImage(this.video.videoElement, 0, 0, theCanvas.width, theCanvas.height);\n\t                checkForSubtitles.call(this);\n\t                if (t === undefined) {\n\t                    t = 0;\n\t                }\n\t                var delta = t - this.previousTime;\n\t                this.previousTime = t;\n\t                postprocessWebGL(delta);\n\t                requestAnimationFrame(drawScreen.bind(this));\n\t            }\n\t\n\t            function postprocessWebGL(delta) {\n\t                GL_TIME += delta;\n\t                webglContext.uniform1f(GL_TIME_UNIFORM, GL_TIME / 1000);\n\t\n\t                webglContext.texImage2D(webglContext.TEXTURE_2D, 0, webglContext.RGBA, webglContext.RGBA, webglContext.UNSIGNED_BYTE, theCanvas);\n\t\n\t                webglContext.viewport(0, 0, webglCanvas.width, webglCanvas.height);\n\t                webglContext.enable(webglContext.DEPTH_TEST);\n\t                webglContext.clear(webglContext.COLOR_BUFFER_BIT);\n\t                webglContext.drawArrays(webglContext.TRIANGLES, 0, 6);\n\t            }\n\t\n\t            function checkForSubtitles() {\n\t                if (this.subtitles.index === this.subtitles.data.length) {\n\t                    return;\n\t                }\n\t                if (this.video.videoElement.currentTime >= this.subtitles.data[this.subtitles.index].endTime) {\n\t                    if (!this.subtitles.flag) {\n\t                        this.video.pause();\n\t                        timerForSubtitles.call(this, 3000);\n\t                        this.subtitles.flag = true;\n\t                    }\n\t                    drawSubtitlesPicture(this.subtitles.data[this.subtitles.index].text);\n\t                }\n\t            }\n\t\n\t            function timerForSubtitles(delay) {\n\t                var _this2 = this;\n\t\n\t                setTimeout(function () {\n\t                    _this2.subtitles.flag = false;\n\t                    if (_this2.pauseFlag) {\n\t                        return false;\n\t                    }\n\t                    _this2.video.play();\n\t                    _this2.subtitles.index++;\n\t                }, 3000);\n\t            }\n\t\n\t            function drawSubtitlesPicture(text) {\n\t                var fontsize = theCanvas.width / 100 * 3;\n\t                context.fillStyle = '#000000';\n\t                context.fillRect(0, 0, theCanvas.width, theCanvas.height);\n\t                context.fillStyle = '#D8D8D8';\n\t                context.font = fontsize + 'px Oranienbaum';\n\t                context.textBaseline = 'middle';\n\t                context.textAlign = 'center';\n\t                createSubtitlesText(text, fontsize);\n\t            }\n\t\n\t            function createSubtitlesText(text, fontsize) {\n\t                var lines = text.split('\\n');\n\t                lines.forEach(function (elem, i) {\n\t                    context.fillText(elem, theCanvas.width / 2, theCanvas.height / 2 + i * fontsize);\n\t                });\n\t            }\n\t        }\n\t    }\n\t\n\t    _createClass(Player, [{\n\t        key: 'play',\n\t        value: function play() {\n\t            this.pauseFlag = false;\n\t            this.playButton.classList.add('player__button_hidden');\n\t            this.pauseButton.classList.remove('player__button_hidden');\n\t            this.video.play();\n\t            this.song.play();\n\t        }\n\t    }, {\n\t        key: 'pause',\n\t        value: function pause() {\n\t            this.pauseFlag = true;\n\t            this.pauseButton.classList.add('player__button_hidden');\n\t            this.playButton.classList.remove('player__button_hidden');\n\t            this.video.pause();\n\t            this.song.pause();\n\t        }\n\t    }]);\n\t\n\t    return Player;\n\t}();\n\t\n\texports.default = Player;\n\n/***/ },\n/* 3 */\n/***/ function(module, exports) {\n\n\t'use strict';\n\t\n\tObject.defineProperty(exports, \"__esModule\", {\n\t    value: true\n\t});\n\t\n\tvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\t\n\tfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\t\n\tvar Song = function () {\n\t    function Song(link) {\n\t        _classCallCheck(this, Song);\n\t\n\t        this.link = link;\n\t        this.audio = new Audio(link);\n\t        this.audio.crossOrigin = 'anonymous';\n\t        this.context = new (window.AudioContext || window.webkitAudioContext)();\n\t        this.source = this.context.createMediaElementSource(this.audio);\n\t        this.gainNode = this.context.createGain();\n\t        this.addDirtyEffects();\n\t    }\n\t\n\t    _createClass(Song, [{\n\t        key: 'addDirtyEffects',\n\t        value: function addDirtyEffects() {\n\t            var distortion = this.context.createWaveShaper();\n\t            var biquadFilter = this.context.createBiquadFilter();\n\t            biquadFilter.type = 'lowpass';\n\t            biquadFilter.frequency.value = 1000;\n\t            biquadFilter.gain.value = 20;\n\t            this.source.connect(distortion);\n\t            distortion.connect(biquadFilter);\n\t            this.generateWHiteNoize();\n\t            this.source.connect(this.gainNode);\n\t            biquadFilter.connect(this.context.destination);\n\t        }\n\t    }, {\n\t        key: 'generateWHiteNoize',\n\t        value: function generateWHiteNoize() {\n\t            var node = this.context.createScriptProcessor(1024, 1, 1);\n\t            node.onaudioprocess = function (e) {\n\t                var output = e.outputBuffer.getChannelData(0);\n\t                for (var i = 0; i < output.length; i++) {\n\t                    output[i] = Math.random();\n\t                }\n\t            };\n\t            node.connect(this.gainNode);\n\t        }\n\t    }, {\n\t        key: 'play',\n\t        value: function play() {\n\t            this.audio.play();\n\t            this.gainNode.connect(this.context.destination);\n\t        }\n\t    }, {\n\t        key: 'pause',\n\t        value: function pause() {\n\t            this.audio.pause();\n\t            this.gainNode.disconnect();\n\t        }\n\t    }]);\n\t\n\t    return Song;\n\t}();\n\t\n\texports.default = Song;\n\n/***/ },\n/* 4 */\n/***/ function(module, exports, __webpack_require__) {\n\n\t'use strict';\n\t\n\tObject.defineProperty(exports, \"__esModule\", {\n\t    value: true\n\t});\n\t\n\tvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\t\n\tvar _subtitlesParser = __webpack_require__(6);\n\t\n\tvar _subtitlesParser2 = _interopRequireDefault(_subtitlesParser);\n\t\n\tfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\t\n\tfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\t\n\tvar Subtitles = function () {\n\t    function Subtitles(link) {\n\t        _classCallCheck(this, Subtitles);\n\t\n\t        this.link = link;\n\t        this.data = null;\n\t        getFile.call(this);\n\t        this.index = 0; // индекс текущих субтитров\n\t        this.flag = false; // в видео еще не было субтитров\n\t\n\t        function getFile() {\n\t            var _this = this;\n\t\n\t            var xhr = new XMLHttpRequest();\n\t            xhr.open('GET', link, true);\n\t            xhr.send();\n\t            xhr.onreadystatechange = function () {\n\t                if (xhr.readyState != 4) return;\n\t                _this.data = _subtitlesParser2.default.fromSrt(xhr.responseText);\n\t                _this.parseData();\n\t            };\n\t        }\n\t    }\n\t\n\t    _createClass(Subtitles, [{\n\t        key: 'parseData',\n\t        value: function parseData() {\n\t            this.data.forEach(function (elem) {\n\t                elem.startTime = countSeconds(elem.startTime);\n\t                elem.endTime = countSeconds(elem.endTime);\n\t            });\n\t\n\t            function countSeconds(time) {\n\t                time = time.replace(/,/g, '.');\n\t                var hours = 60 * time.slice(0, 2);\n\t                var minutes = 60 * (hours + Number(time.slice(3, 5)));\n\t                var seconds = minutes + Number(time.slice(6, 12));\n\t                return seconds;\n\t            }\n\t        }\n\t    }]);\n\t\n\t    return Subtitles;\n\t}();\n\t\n\texports.default = Subtitles;\n\n/***/ },\n/* 5 */\n/***/ function(module, exports) {\n\n\t'use strict';\n\t\n\tObject.defineProperty(exports, \"__esModule\", {\n\t    value: true\n\t});\n\t\n\tvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\t\n\tfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\t\n\tvar Video = function () {\n\t    function Video(link, pagePlayer) {\n\t        _classCallCheck(this, Video);\n\t\n\t        this.videoElement = document.createElement('video');\n\t        this.videoElement.setAttribute('crossorigin', 'anonymous');\n\t        this.videoDiv = document.createElement('div');\n\t        pagePlayer.appendChild(this.videoDiv);\n\t        this.videoDiv.appendChild(this.videoElement);\n\t        this.videoDiv.setAttribute('style', 'display:none;');\n\t        this.videoElement.setAttribute('src', link);\n\t        this.videoElement.muted = true;\n\t    }\n\t\n\t    _createClass(Video, [{\n\t        key: 'play',\n\t        value: function play() {\n\t            this.videoElement.play();\n\t        }\n\t    }, {\n\t        key: 'pause',\n\t        value: function pause() {\n\t            this.videoElement.pause();\n\t        }\n\t    }]);\n\t\n\t    return Video;\n\t}();\n\t\n\texports.default = Video;\n\n/***/ },\n/* 6 */\n/***/ function(module, exports, __webpack_require__) {\n\n\tvar parser = (function() {\n\t    var pItems = {};\n\t\n\t    /**\n\t     * Converts SubRip subtitles into array of objects\n\t     * [{\n\t     *     id:        `Number of subtitle`\n\t     *     startTime: `Start time of subtitle`\n\t     *     endTime:   `End time of subtitle\n\t     *     text: `Text of subtitle`\n\t     * }]\n\t     *\n\t     * @param  {String}  data SubRip suntitles string\n\t     * @param  {Boolean} ms   Optional: use milliseconds for startTime and endTime\n\t     * @return {Array}  \n\t     */\n\t    pItems.fromSrt = function(data, ms) {\n\t        var useMs = ms ? true : false;\n\t\n\t        data = data.replace(/\\r/g, '');\n\t        var regex = /(\\d+)\\n(\\d{2}:\\d{2}:\\d{2},\\d{3}) --> (\\d{2}:\\d{2}:\\d{2},\\d{3})/g;\n\t        data = data.split(regex);\n\t        data.shift();\n\t\n\t        var items = [];\n\t        for (var i = 0; i < data.length; i += 4) {\n\t            items.push({\n\t                id: data[i].trim(),\n\t                startTime: useMs ? timeMs(data[i + 1].trim()) : data[i + 1].trim(),\n\t                endTime: useMs ? timeMs(data[i + 2].trim()) : data[i + 2].trim(),\n\t                text: data[i + 3].trim()\n\t            });\n\t        }\n\t\n\t        return items;\n\t    };\n\t\n\t    /**\n\t     * Converts Array of objects created by this module to SubRip subtitles\n\t     * @param  {Array}  data\n\t     * @return {String}      SubRip subtitles string\n\t     */\n\t    pItems.toSrt = function(data) {\n\t        if (!data instanceof Array) return '';\n\t        var res = '';\n\t\n\t        for (var i = 0; i < data.length; i++) {\n\t            var s = data[i];\n\t\n\t            if (!isNaN(s.startTime) && !isNaN(s.endTime)) {\n\t                s.startTime = msTime(parseInt(s.startTime, 10));\n\t                s.endTime = msTime(parseInt(s.endTime, 10));\n\t            }\n\t\n\t            res += s.id + '\\r\\n';\n\t            res += s.startTime + ' --> ' + s.endTime + '\\r\\n';\n\t            res += s.text.replace('\\n', '\\r\\n') + '\\r\\n\\r\\n';\n\t        }\n\t\n\t        return res;\n\t    };\n\t\n\t    var timeMs = function(val) {\n\t        var regex = /(\\d+):(\\d{2}):(\\d{2}),(\\d{3})/;\n\t        var parts = regex.exec(val);\n\t\n\t        if (parts === null) {\n\t            return 0;\n\t        }\n\t\n\t        for (var i = 1; i < 5; i++) {\n\t            parts[i] = parseInt(parts[i], 10);\n\t            if (isNaN(parts[i])) parts[i] = 0;\n\t        }\n\t\n\t        // hours + minutes + seconds + ms\n\t        return parts[1] * 3600000 + parts[2] * 60000 + parts[3] * 1000 + parts[4];\n\t    };\n\t\n\t    var msTime = function(val) {\n\t        var measures = [ 3600000, 60000, 1000 ]; \n\t        var time = [];\n\t\n\t        for (var i in measures) {\n\t            var res = (val / measures[i] >> 0).toString();\n\t            \n\t            if (res.length < 2) res = '0' + res;\n\t            val %= measures[i];\n\t            time.push(res);\n\t        }\n\t\n\t        var ms = val.toString();\n\t        if (ms.length < 3) {\n\t            for (i = 0; i <= 3 - ms.length; i++) ms = '0' + ms;\n\t        }\n\t\n\t        return time.join(':') + ',' + ms;\n\t    };\n\t\n\t    return pItems;\n\t})();\n\t\n\t// ignore exports for browser\n\tif (true) {\n\t    module.exports = parser;\n\t}\n\n\n/***/ }\n/******/ ]);\n\n\n/** WEBPACK FOOTER **\n ** bundle.js\n **/"," \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId])\n \t\t\treturn installedModules[moduleId].exports;\n\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\texports: {},\n \t\t\tid: moduleId,\n \t\t\tloaded: false\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.loaded = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(0);\n\n\n\n/** WEBPACK FOOTER **\n ** webpack/bootstrap 2eec2b56b0c7d78b337d\n **/","import App from './app';\n\ndocument.addEventListener('DOMContentLoaded', onDOMContentLoaded);\n\nfunction onDOMContentLoaded() {\n    window.app = new App();\n}\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/js/index.js\n **/","import Player from './player';\n\nexport default class App {\n    constructor() {\n        // если ипсользовать ссылки со сторонних сайтов, то пригодится cors-сервер\n        // const crossorigin = 'http://cors.io/?u=';\n        const crossorigin = '';\n        this.form = document.querySelector('.panel__form');\n        this.pages = {\n            'pageForm': document.querySelector('.page_content_form'),\n            'pagePreloader': document.querySelector('.page_content_preloader'),\n            'pagePlayer': document.querySelector('.page_content_player')\n        };\n\n        this.links = {\n            video: '',\n            subtitles: '',\n            audio: ''\n        };\n\n        this.form.addEventListener('submit', onFormSubmit.bind(this));\n\n        function onFormSubmit(e) {\n            e.preventDefault();\n\n            this.links.video = crossorigin + this.form.querySelector('[name=\"video\"]').value;\n            this.links.subtitles = crossorigin + this.form.querySelector('[name=\"subtitles\"]').value;\n            this.links.audio = crossorigin + this.form.querySelector('[name=\"audio\"]').value;\n\n            this.pages.pageForm.classList.add('page_hidden');\n            this.pages.pagePreloader.classList.remove('page_hidden');\n            this.pages.player = new Player(this.links, this.pages);\n        }\n    }\n}\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/js/app.js\n **/","import Song from './song';\nimport Video from './video';\nimport Subtitles from './subtitles';\n\nexport default class Player {\n    constructor(links, pages) {\n\n        this.pagePlayer = pages.pagePlayer;\n        this.pagePreloader = pages.pagePreloader;\n        this.player = this.pagePlayer.querySelector('.player');\n        this.playButton = this.player.querySelector('.player__button_function_play');\n        this.pauseButton = this.player.querySelector('.player__button_function_pause');\n        this.video = new Video(links.video, this.pagePlayer);\n        this.song = new Song(links.audio);\n        this.subtitles = new Subtitles(links.subtitles);\n        this.previousTime = 0;\n        this.pauseFlag = true;\n\n        this.video.videoElement.addEventListener('canplaythrough', () => {\n            this.pagePlayer.classList.remove('page_hidden');\n            this.pagePreloader.classList.add('page_hidden');\n            init.call(this, this.video.videoElement.videoWidth, this.video.videoElement.videoHeight);\n        });\n        this.playButton.addEventListener('click', () => {\n            this.play();\n        });\n        this.pauseButton.addEventListener('click', () => {\n            this.pause();\n        });\n\n        function init(videoWidth, videoHeight) {\n            let theCanvas = document.getElementById('canvas');\n            let context = theCanvas.getContext('2d');\n            let webglCanvas = document.getElementById('webgl-canvas');\n            let webglContext = webglCanvas.getContext('webgl') || webglCanvas.getContext('experimental-webgl');\n            webglCanvas.width = theCanvas.width = videoWidth;\n            webglCanvas.height = theCanvas.height = videoHeight;\n\n            let GL_TIME = 0;\n            let GL_TIME_UNIFORM = null;\n\n            prepareWebGL.call(this);\n\n            this.play();\n\n            drawScreen.call(this);\n\n            function prepareWebGL(canvas, gl, sourceCanvas) {\n                const program = webglContext.createProgram();\n\n                let vertexCode = 'attribute vec2 coordinates;' +\n                    'attribute vec2 texture_coordinates;' +\n                    'varying vec2 v_texcoord;' +\n                    'void main() {' +\n                    '  gl_Position = vec4(coordinates, 0.0, 1.0);' +\n                    '  v_texcoord = texture_coordinates;' +\n                    '}';\n\n                let vertexShader = webglContext.createShader(webglContext.VERTEX_SHADER);\n                webglContext.shaderSource(vertexShader, vertexCode);\n                webglContext.compileShader(vertexShader);\n\n                let fragmentCode = 'precision mediump float;' +\n                    'varying vec2 v_texcoord;' +\n                    'uniform sampler2D u_texture;' +\n                    'uniform float u_time;' +\n                    'uniform vec2 u_resolution;' +\n                    'vec2 uv;' +\n\n                    'vec3 grayscale (vec3 color) {' +\n                    '   return vec3(0.2126*color.r + 0.7152*color.g + 0.0722*color.b);' +\n                    '}' +\n\n                    'float rand(vec2 co){' +\n                    '   return fract(sin(dot(co.xy ,vec2(12.9898,78.233))) * 43758.5453);' +\n                    '}' +\n\n                    'float rand(float c){' +\n                    '   return rand(vec2(c,1.0));' +\n                    '}' +\n\n                    'float randomLine(float seed){' +\n                    '   float b = 0.01 * rand(seed);' +\n                    '   float a = rand(seed+1.0);' +\n                    '   float c = rand(seed+2.0) - 0.5;' +\n                    '   float mu = rand(seed+3.0);' +\n                    '   float l = 1.0;' +\n                    '   if ( mu > 0.2)' +\n                    '   l = pow(  abs(a * uv.x + b * uv.y + c ), 1.0/8.0 );' +\n                    '   else' +\n                    '   l = 2.0 - pow( abs(a * uv.x + b * uv.y + c), 1.0/8.0 );' +\n                    '   return mix(0.5, 1.0, l);' +\n                    '}' +\n\n                    'float randomBlotch(float seed){' +\n                    '\t  float x = rand(seed);' +\n                    '\t  float y = rand(seed+1.0);' +\n                    '\t  float s = 0.01 * rand(seed+2.0);' +\n                    '\t  vec2 p = vec2(x,y) - uv;' +\n                    '\t  p.x *= u_resolution.x / u_resolution.y;' +\n                    '\t  float a = atan(p.y,p.x);' +\n                    '\t  float v = 1.0;' +\n                    '\t  float ss = s*s * (sin(6.2831*a*x)*0.1 + 1.0);' +\n                    '\t  if ( dot(p,p) < ss ) v = 0.2;' +\n                    '\t  else' +\n                    '\t\tv = pow(dot(p,p) - ss, 1.0/16.0);' +\n                    '   return mix(0.3 + 0.2 * (1.0 - (s / 0.02)), 1.0, v);' +\n                    '}' +\n\n                    'void main() {' +\n                    '   uv = v_texcoord.xy;' +\n                    '   float t = float(int(u_time * 20.0));' +\n                    // Сохраняем кадр\n                    '   vec3 image = texture2D(u_texture, uv).rgb;' +\n                    // Добавляем ч/б\n                    '   float luma = dot( vec3(0.2126, 0.7152, 0.0722), image );' +\n                    '   image = luma * vec3(0.7, 0.7, 0.7);' +\n                    // Create a time-varyting vignetting effect\n                    '   float vI = 16.0 * (uv.x * (1.0-uv.x) * uv.y * (1.0-uv.y));' +\n                    'vI *= mix( 0.7, 1.0, rand(t + 0.5));' +\n                    // Add additive flicker\n                    'vI += 1.0 + 0.4 * rand(t+8.);' +\n                    // Add a fixed vignetting (independent of the flicker)\n                    'vI *= pow(16.0 * uv.x * (1.0-uv.x) * uv.y * (1.0-uv.y), 0.4);' +\n\n                    // Случайные линии\n                    'int l = int(8.0 * rand(t+7.0));' +\n                    'if ( 0 < l ) vI *= randomLine( t+6.0+17.* float(0));' +\n                    'if ( 1 < l ) vI *= randomLine( t+6.0+17.* float(1));' +\n                    'if ( 2 < l ) vI *= randomLine( t+6.0+17.* float(2));' +\n                    'if ( 3 < l ) vI *= randomLine( t+6.0+17.* float(3));' +\n                    'if ( 4 < l ) vI *= randomLine( t+6.0+17.* float(4));' +\n                    'if ( 5 < l ) vI *= randomLine( t+6.0+17.* float(5));' +\n                    'if ( 6 < l ) vI *= randomLine( t+6.0+17.* float(6));' +\n                    'if ( 7 < l ) vI *= randomLine( t+6.0+17.* float(7));' +\n\n                    // Случайные пятна\n                    'image = image * vI;' +\n                    'gl_FragColor = vec4(image, 1.0);' +\n\n                    // Черно-белый эффект (первоначальный метод)\n                    // '   gl_FragColor = vec4(grayscale(texture2D(u_texture, v_texcoord).rgb), 1.0);' +\n                    // Зернистость\n                    '   gl_FragColor.xyz *= (1.0+(rand(uv+t*.01)-.2)*.15);\t' +\n                    '}';\n\n                let fragmentShader = webglContext.createShader(webglContext.FRAGMENT_SHADER);\n                webglContext.shaderSource(fragmentShader, fragmentCode);\n                webglContext.compileShader(fragmentShader);\n\n                webglContext.attachShader(program, vertexShader);\n                webglContext.attachShader(program, fragmentShader);\n\n                webglContext.linkProgram(program);\n                webglContext.useProgram(program);\n\n                let positionLocation = webglContext.getAttribLocation(program, 'coordinates');\n                let texcoordLocation = webglContext.getAttribLocation(program, 'texture_coordinates');\n                GL_TIME_UNIFORM = webglContext.getUniformLocation(program, 'u_time');\n                let resolutionLocation = webglContext.getUniformLocation(program, 'u_resolution');\n                webglContext.uniform2f(resolutionLocation, webglCanvas.width, webglCanvas.height);\n\n\n                let buffer = webglContext.createBuffer();\n                let vertices = [-1, -1,\n                    1, -1, -1, 1, -1, 1,\n                    1, -1,\n                    1, 1\n                ];\n                webglContext.bindBuffer(webglContext.ARRAY_BUFFER, buffer);\n                webglContext.bufferData(webglContext.ARRAY_BUFFER, new Float32Array(vertices), webglContext.STATIC_DRAW);\n                webglContext.enableVertexAttribArray(positionLocation);\n                webglContext.vertexAttribPointer(positionLocation, 2, webglContext.FLOAT, false, 0, 0);\n\n                buffer = webglContext.createBuffer();\n                let textureCoordinates = [\n                    0, 1,\n                    1, 1,\n                    0, 0,\n                    0, 0,\n                    1, 1,\n                    1, 0\n                ];\n                webglContext.bindBuffer(webglContext.ARRAY_BUFFER, buffer);\n                webglContext.bufferData(webglContext.ARRAY_BUFFER, new Float32Array(textureCoordinates), webglContext.STATIC_DRAW);\n                webglContext.enableVertexAttribArray(texcoordLocation);\n                webglContext.vertexAttribPointer(texcoordLocation, 2, webglContext.FLOAT, false, 0, 0);\n\n                let texture = webglContext.createTexture();\n                webglContext.bindTexture(webglContext.TEXTURE_2D, texture);\n                webglContext.texParameteri(webglContext.TEXTURE_2D, webglContext.TEXTURE_WRAP_S, webglContext.CLAMP_TO_EDGE);\n                webglContext.texParameteri(webglContext.TEXTURE_2D, webglContext.TEXTURE_WRAP_T, webglContext.CLAMP_TO_EDGE);\n                webglContext.texParameteri(webglContext.TEXTURE_2D, webglContext.TEXTURE_MIN_FILTER, webglContext.NEAREST);\n                webglContext.texParameteri(webglContext.TEXTURE_2D, webglContext.TEXTURE_MAG_FILTER, webglContext.NEAREST);\n\n            }\n\n            function drawScreen(t) {\n                if (this.video.videoElement.ended) {\n                    return;\n                }\n                context.drawImage(this.video.videoElement, 0, 0, theCanvas.width, theCanvas.height);\n                checkForSubtitles.call(this);\n                if (t === undefined) {\n                    t = 0;\n                }\n                let delta = t - this.previousTime;\n                this.previousTime = t;\n                postprocessWebGL(delta);\n                requestAnimationFrame(drawScreen.bind(this));\n            }\n\n            function postprocessWebGL(delta) {\n                GL_TIME += delta;\n                webglContext.uniform1f(GL_TIME_UNIFORM, GL_TIME / 1000);\n\n                webglContext.texImage2D(webglContext.TEXTURE_2D, 0, webglContext.RGBA, webglContext.RGBA, webglContext.UNSIGNED_BYTE, theCanvas);\n\n                webglContext.viewport(0, 0, webglCanvas.width, webglCanvas.height);\n                webglContext.enable(webglContext.DEPTH_TEST);\n                webglContext.clear(webglContext.COLOR_BUFFER_BIT);\n                webglContext.drawArrays(webglContext.TRIANGLES, 0, 6);\n            }\n\n            function checkForSubtitles() {\n                if (this.subtitles.index === this.subtitles.data.length) {\n                    return;\n                }\n                if (this.video.videoElement.currentTime >= this.subtitles.data[this.subtitles.index].endTime) {\n                    if (!this.subtitles.flag) {\n                        this.video.pause();\n                        timerForSubtitles.call(this, 3000);\n                        this.subtitles.flag = true;\n                    }\n                    drawSubtitlesPicture(this.subtitles.data[this.subtitles.index].text);\n                }\n\n            }\n\n            function timerForSubtitles(delay) {\n                setTimeout(() => {\n                    this.subtitles.flag = false;\n                    if (this.pauseFlag) {\n                        return false;\n                    }\n                    this.video.play();\n                    this.subtitles.index++;\n                }, 3000);\n            }\n\n            function drawSubtitlesPicture(text) {\n                const fontsize = theCanvas.width / 100 * 3;\n                context.fillStyle = '#000000';\n                context.fillRect(0, 0, theCanvas.width, theCanvas.height);\n                context.fillStyle = '#D8D8D8';\n                context.font = `${fontsize}px Oranienbaum`;\n                context.textBaseline = 'middle';\n                context.textAlign = 'center';\n                createSubtitlesText(text, fontsize);\n            }\n\n            function createSubtitlesText(text, fontsize) {\n                let lines = text.split('\\n');\n                lines.forEach((elem, i) => {\n                    context.fillText(elem, theCanvas.width / 2, (theCanvas.height / 2) + i * fontsize);\n                });\n            }\n        }\n    }\n\n    play() {\n        this.pauseFlag = false;\n        this.playButton.classList.add('player__button_hidden');\n        this.pauseButton.classList.remove('player__button_hidden');\n        this.video.play();\n        this.song.play();\n    }\n    pause() {\n        this.pauseFlag = true;\n        this.pauseButton.classList.add('player__button_hidden');\n        this.playButton.classList.remove('player__button_hidden');\n        this.video.pause();\n        this.song.pause();\n    }\n}\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/js/player.js\n **/","export default class Song {\n    constructor(link) {\n        this.link = link;\n        this.audio = new Audio(link);\n        this.audio.crossOrigin = 'anonymous';\n        this.context = new (window.AudioContext || window.webkitAudioContext);\n        this.source = this.context.createMediaElementSource(this.audio);\n        this.gainNode = this.context.createGain();\n        this.addDirtyEffects();\n\n    }\n    addDirtyEffects() {\n        const distortion = this.context.createWaveShaper();\n        const biquadFilter = this.context.createBiquadFilter();\n        biquadFilter.type = 'lowpass';\n        biquadFilter.frequency.value = 1000;\n        biquadFilter.gain.value = 20;\n        this.source.connect(distortion);\n        distortion.connect(biquadFilter);\n        this.generateWHiteNoize();\n        this.source.connect(this.gainNode);\n        biquadFilter.connect(this.context.destination);\n    }\n    generateWHiteNoize() {\n        const node = this.context.createScriptProcessor(1024, 1, 1);\n        node.onaudioprocess = (e) => {\n            let output = e.outputBuffer.getChannelData(0);\n            for (let i = 0; i < output.length; i++) {\n                output[i] = Math.random();\n            }\n        };\n        node.connect(this.gainNode);\n    }\n    play() {\n        this.audio.play();\n        this.gainNode.connect(this.context.destination);\n    }\n    pause() {\n        this.audio.pause();\n        this.gainNode.disconnect();\n    }\n}\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/js/song.js\n **/","import parser from 'subtitles-parser';\n\n\nexport default class Subtitles {\n    constructor(link) {\n        this.link = link;\n        this.data = null;\n        getFile.call(this);\n        this.index = 0; // индекс текущих субтитров\n        this.flag = false; // в видео еще не было субтитров\n\n        function getFile() {\n            let xhr = new XMLHttpRequest();\n            xhr.open('GET', link, true);\n            xhr.send();\n            xhr.onreadystatechange = () => {\n                if (xhr.readyState != 4) return;\n                this.data = parser.fromSrt(xhr.responseText);\n                this.parseData();\n            }\n        }\n    }\n    parseData() {\n        this.data.forEach((elem) => {\n            elem.startTime = countSeconds(elem.startTime);\n            elem.endTime = countSeconds(elem.endTime);\n        });\n\n        function countSeconds(time) {\n            time = time.replace(/,/g, '.');\n            let hours = 60 * time.slice(0, 2);\n            let minutes = 60 * (hours + Number(time.slice(3, 5)));\n            let seconds = minutes + Number(time.slice(6, 12));\n            return seconds;\n        }\n\n    }\n}\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/js/subtitles.js\n **/","export default class Video {\n    constructor(link, pagePlayer) {\n        this.videoElement = document.createElement('video');\n        this.videoElement.setAttribute('crossorigin', 'anonymous');\n        this.videoDiv = document.createElement('div');\n        pagePlayer.appendChild(this.videoDiv);\n        this.videoDiv.appendChild(this.videoElement);\n        this.videoDiv.setAttribute('style', 'display:none;');\n        this.videoElement.setAttribute('src', link);\n        this.videoElement.muted = true;\n    }\n    play() {\n        this.videoElement.play();\n    }\n    pause() {\n        this.videoElement.pause();\n    }\n}\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/js/video.js\n **/","var parser = (function() {\n    var pItems = {};\n\n    /**\n     * Converts SubRip subtitles into array of objects\n     * [{\n     *     id:        `Number of subtitle`\n     *     startTime: `Start time of subtitle`\n     *     endTime:   `End time of subtitle\n     *     text: `Text of subtitle`\n     * }]\n     *\n     * @param  {String}  data SubRip suntitles string\n     * @param  {Boolean} ms   Optional: use milliseconds for startTime and endTime\n     * @return {Array}  \n     */\n    pItems.fromSrt = function(data, ms) {\n        var useMs = ms ? true : false;\n\n        data = data.replace(/\\r/g, '');\n        var regex = /(\\d+)\\n(\\d{2}:\\d{2}:\\d{2},\\d{3}) --> (\\d{2}:\\d{2}:\\d{2},\\d{3})/g;\n        data = data.split(regex);\n        data.shift();\n\n        var items = [];\n        for (var i = 0; i < data.length; i += 4) {\n            items.push({\n                id: data[i].trim(),\n                startTime: useMs ? timeMs(data[i + 1].trim()) : data[i + 1].trim(),\n                endTime: useMs ? timeMs(data[i + 2].trim()) : data[i + 2].trim(),\n                text: data[i + 3].trim()\n            });\n        }\n\n        return items;\n    };\n\n    /**\n     * Converts Array of objects created by this module to SubRip subtitles\n     * @param  {Array}  data\n     * @return {String}      SubRip subtitles string\n     */\n    pItems.toSrt = function(data) {\n        if (!data instanceof Array) return '';\n        var res = '';\n\n        for (var i = 0; i < data.length; i++) {\n            var s = data[i];\n\n            if (!isNaN(s.startTime) && !isNaN(s.endTime)) {\n                s.startTime = msTime(parseInt(s.startTime, 10));\n                s.endTime = msTime(parseInt(s.endTime, 10));\n            }\n\n            res += s.id + '\\r\\n';\n            res += s.startTime + ' --> ' + s.endTime + '\\r\\n';\n            res += s.text.replace('\\n', '\\r\\n') + '\\r\\n\\r\\n';\n        }\n\n        return res;\n    };\n\n    var timeMs = function(val) {\n        var regex = /(\\d+):(\\d{2}):(\\d{2}),(\\d{3})/;\n        var parts = regex.exec(val);\n\n        if (parts === null) {\n            return 0;\n        }\n\n        for (var i = 1; i < 5; i++) {\n            parts[i] = parseInt(parts[i], 10);\n            if (isNaN(parts[i])) parts[i] = 0;\n        }\n\n        // hours + minutes + seconds + ms\n        return parts[1] * 3600000 + parts[2] * 60000 + parts[3] * 1000 + parts[4];\n    };\n\n    var msTime = function(val) {\n        var measures = [ 3600000, 60000, 1000 ]; \n        var time = [];\n\n        for (var i in measures) {\n            var res = (val / measures[i] >> 0).toString();\n            \n            if (res.length < 2) res = '0' + res;\n            val %= measures[i];\n            time.push(res);\n        }\n\n        var ms = val.toString();\n        if (ms.length < 3) {\n            for (i = 0; i <= 3 - ms.length; i++) ms = '0' + ms;\n        }\n\n        return time.join(':') + ',' + ms;\n    };\n\n    return pItems;\n})();\n\n// ignore exports for browser\nif (typeof exports === 'object') {\n    module.exports = parser;\n}\n\n\n\n/*****************\n ** WEBPACK FOOTER\n ** ./~/subtitles-parser/index.js\n ** module id = 6\n ** module chunks = 0\n **/"],"sourceRoot":""}